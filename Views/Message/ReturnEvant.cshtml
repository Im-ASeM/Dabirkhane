@{
    Layout = "_layoutMail";
}

<!-- Content -->
<div class="container-xxl flex-grow-1 container-p-y">
    @if (ViewBag.Error != null)
    {
        <div class="alert alert-solid-danger alert-dismissible d-flex align-items-center" role="alert">
            @ViewBag.Error
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    <div class="card mb-4">
        
        <div class="card-header align-items-center">
            <h5 class="card-action-title mb-3"><i class="bx bx-list-ul bx-sm me-2"></i>خط زمانی رویداد ها
            </h5>
        </div>
        <div class="card-body">
            <ul class="timeline ms-2">
                @foreach (var item in ViewBag.Msg.logs)

                {
                    <li class="timeline-item timeline-item-transparent">
                        <span class="timeline-point timeline-point-warning"></span>
                        <div class="timeline-event">
                            <div class="timeline-header mb-1">
                                <h6 class="mb-0 mt-n1">Fix soon #1</h6>
                                <small class="text-muted mt-1 mt-sm-0 mb-1 mb-sm-0">
                                    @PubDo.persianDate(item.CreateDateTime).Item1
                                    @PubDo.persianDate(item.CreateDateTime).Item2
                                </small>
                            </div>
                            <div class="d-flex flex-wrap align-items-center">
                                <div class="avatar me-3 mt-1">
                                    <img src="@item.User.Profile" alt="آواتار" class="rounded-circle">
                                </div>
                                <div>
                                    <h6 class="mb-1">@item.User.FirstName @item.User.LastName
                                        (@item.User.Username)</h6>
                                    <span>@item.Description</span>
                                </div>
                            </div>
                        </div>
                    </li>
                }
            </ul>
        </div>
        <nav aria-label="Page navigation">
            <ul class="pagination">
                @if (ViewBag.msg.logPage - 2 > 0)
                {
                    <li class="page-item first">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=1"><i
                                class="tf-icon bx bx-chevrons-left"></i></a>
                    </li>
                }
                @if (ViewBag.msg.logPage - 1 != 0)
                {
                    <li class="page-item prev">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage-1)"><i
                                class="tf-icon bx bx-chevron-left"></i></a>
                    </li>
                }
                @if (ViewBag.msg.logPage - 2 > 0)

                {
                    <li class="page-item">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage-2)">@(ViewBag.msg.logPage -
                        2)</a>
                    </li>
                }
                @if (ViewBag.msg.logPage - 1 > 0)

                {
                    <li class="page-item">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage-1)">@(ViewBag.msg.logPage -
                        1)</a>
                    </li>
                }
                <li class="page-item active">
                    <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@ViewBag.msg.logPage">@ViewBag.msg.logPage</a>
                </li>
                @if (ViewBag.msg.logPage + 1 <= ViewBag.msg.logCount)

                {
                    <li class="page-item">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage+1)">@(ViewBag.msg.logPage +
                        1)</a>
                    </li>
                }
                @if (ViewBag.msg.logPage + 1 < ViewBag.msg.logCount)

                {
                    <li class="page-item">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage+2)">@(ViewBag.msg.logPage +
                        2)</a>
                    </li>
                }
                @if (ViewBag.msg.logPage + 1 <= ViewBag.msg.logCount)

                {
                    <li class="page-item next">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@(ViewBag.msg.logPage+1)"><i
                                class="tf-icon bx bx-chevron-right"></i></a>
                    </li>
                }
                @if (ViewBag.msg.logPage + 1 < ViewBag.msg.logCount)

                {
                    <li class="page-item last">
                        <a class="page-link" href="/Message/ReturnEvant/@ViewBag.msg.Id?page=@ViewBag.msg.logCount"><i
                                class="tf-icon bx bx-chevrons-right"></i></a>
                    </li>
                }
            </ul>
        </nav>
    </div>

</div>@* <div class="tab-pane fade" id="rply" role="tabpanel">
@foreach (var item in ViewBag.Messages.Item1[0].Child)

{
<br>
<div class="card card-action mb-4">
<div class="card-body">
<div class="row md-3">
<div class="card-header d-flex align-items-center justify-content-between">
<h5 class="mb-0">@item.SenderFirstName @item.SenderLastName (@item.SenderUser)</h5>
<small class="text-muted float-end primary-font">
@item.CreateTime
@item.CreateDate
</small>
</div>
<div class="row mb-3">
<label class="col-sm-2 col-form-label" for="basic-default-company">موضوع</label>
<div class="col-sm-10">
<input type="text" readonly disabled class="form-control" id="basic-default-company"
placeholder="موضوع (subject) ایمیل را وارد کنید" name="Subject" value="@item.ReplySubject">
</div>
</div>
<div class="row mb-3">
<label class="col-sm-2 col-form-label">پیام</label>
<div class="col-sm-10">
<div class="form-control">
@Html.Raw(item.ReplyBodyText)
</div>
</div>
</div>
@if (item.Files.Count != 0)
{
<div class="row mb-3">
<label class="col-sm-2 col-form-label" for="upload">فایل های پیوست شده</label>
<div class="col-sm-10">
@foreach (var item2 in item.Files)

{
<a type="button" class="btn btn-primary" href="@item2.FilePath"
target="_blank">@item2.FileName</a>
}
</div>
</div>
}
</div>
</div>
</div>

<br>
}
</div> *@

<!--/ Content -->
